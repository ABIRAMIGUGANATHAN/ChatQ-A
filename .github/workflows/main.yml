deploy-chatqna:
    runs-on: ubuntu-latest

      steps:
        - name: 📥 Checkout Repository
          uses: actions/checkout@v4
    
        - name: 🐳 Deploy ChatQnA
          run: |
            COMPOSE_PATH="docker_compose/intel/cpu/xeon/compose.yaml"
            docker compose -f $COMPOSE_PATH down  # Stop existing containers
            docker compose -f $COMPOSE_PATH up -d
    
        - name: 🔍 Verify Running Containers
          run: docker ps -a
    
        - name: 🛠 Debug Logs (Optional)
          if: failure()
          run: docker compose -f docker_compose/intel/cpu/xeon/compose.yaml logs
    
        - name: 📝 Test ChatQnA API
          run: |
            sleep 10  # Wait for the service to initialize
            RESPONSE=$(curl -s -X POST http://localhost:8888/v1/chatqna \
              -H "Content-Type: application/json" \
              -d '{"messages": "What is the revenue of Nike in 2023?"}')
            echo "ChatQnA API Response: $RESPONSE"
        
        - name: ✅ Deployment Completed
          run: echo "ChatQnA deployment successful!"
